---
description: Documentation standards and workflow - critical rules for doc creation
alwaysApply: true
---

# Documentation Standards

Documentation philosophy and tooling for Lumenize.

## ⚠️ CRITICAL: Never Add @skip-check Without Asking

**Exceptions:**
1. **Non-executable examples** - Bash commands, configuration snippets, install commands
2. **Phase 1 of documentation workflow** - Temporary use during narrative drafting with explicit approval

**Phase 1 Exception:** During narrative-first drafting (Phase 1), `@skip-check` can be used temporarily. However, the transition from Phase 1 → Phase 2 must be explicitly approved by the user, acknowledging that all `@skip-check` annotations will be replaced with `@check-example` annotations pointing to real tests.

**Never:** Use `@skip-check` for final pedagogical code examples without validation tests.

**Why:** `@skip-check` creates risk of docs/code divergence. Every code example showing functionality should be validated.

**Ask First:** If you think @skip-check is needed outside these exceptions, ask the user.

## Philosophy

Documentation quality is ensured by custom Docusaurus tooling that guarantees all code examples are tested and working. The website at https://lumenize.com is the single source of truth for user-facing documentation.

All documentation is hand-written `.mdx` with code examples validated by the `check-examples` plugin. API references are hand-written pages (not auto-generated). See `website/docs/auth/api-reference.mdx` for the pattern.

## Where Documentation Lives

### Website Documentation (`/website/docs/`)

**Always:**
- ✅ All user-facing documentation goes here
- ✅ Create/update `.mdx` files in `/website/docs/[package-name]/`
- ✅ Add new files to `/website/sidebars.ts` for navigation
- ✅ Use proper frontmatter with `title` and `description`
- ✅ Link between pages with relative links (e.g., `[CORS Support](/docs/utils/cors-support)`)
- ✅ Large features should be separate files linked from main docs

**Never:**
- ❌ Don't create temporary docs in package directories (`IMPLEMENTATION.md`, `FEATURE_GUIDE.md`, etc.)
- ❌ Don't include internal communication content (testing details, compatibility matrices, progress updates)

### Package README.md Files

**Always keep minimal:**
- ✅ Name, tagline with de✨light✨ful branding
- ✅ Link to website documentation
- ✅ Key features (bullet list)
- ✅ Installation command

**Standard structure:**
```markdown
# @lumenize/package-name

A de✨light✨ful [one-line description].

For complete documentation, visit **[https://lumenize.com/docs/package-name](https://lumenize.com/docs/package-name)**

## Features

- **Feature 1**: Brief description
- **Feature 2**: Brief description

## Installation

\`\`\`bash
npm install @lumenize/package-name
\`\`\`
```

## Documentation Tooling

### `check-examples` - Code Example Validation Plugin

- Scans hand-written `.mdx` files for code blocks with `@check-example` annotations
- Each annotation includes a path to a passing test file
- Fails the build if documentation code doesn't match test code
- Supports `// ...` wildcards in code blocks to skip boilerplate

### Deprecated tooling

- **`doc-testing`** — Generated `.mdx` from test files with embedded markdown. Do not use for new work. Some older packages still have generated files marked with `generated_by: doc-testing` frontmatter — do not hand-edit those.
- **TypeDoc** — Auto-generated API reference from JSDoc. Do not use for new work. Replaced by hand-written API reference pages.

### Running Validation

```bash
# Fast validation (recommended during development)
cd website && npm run check-examples

# Full website build (slower, full validation)
cd website && npm run build
```

## Code Example Validation

### `@check-example` Annotations

**Always:**
```typescript
\`\`\`typescript @check-example('packages/rpc/test/for-docs/basic-usage.test.ts')
const client = await createRpcClient(stub);
const result = await client.echo('Hello');
expect(result).toBe('DO echoed: Hello');
\`\`\`
```

**Rules:**
- ✅ Every code example must be validated against a passing test
- ✅ Use `// ...` or `/* ... */` to skip boilerplate
- ✅ Import statements are automatically skipped

**Never:**
```typescript
\`\`\`typescript @skip-check
// Only for non-executable examples like bash commands
npm install @lumenize/package
\`\`\`
```

## Documentation Workflow

For the complete 4-phase documentation process, use the command:
- **Command:** `/documentation-workflow`

**Quick reference:**
1. **Phase 1**: Narrative & Pedagogy First (use `@skip-check` temporarily)
2. **Phase 2**: Make Examples Real (create `test/for-docs/` tests)
3. **Phase 3**: Fast Validation Loop (`npm run check-examples`)
4. **Phase 4**: Full Build & Polish (`npm run build`)

## API Reference Pages

For packages with public APIs, write a hand-written API reference page. Include:
- **Summary table** at the top with links to detailed sections
- **Environment variables table** if applicable
- **Function signatures** with options and defaults
- **Detailed sections** for each endpoint/function with request/response examples

Keep JSDoc in source code focused: parameter descriptions, return types, brief explanation, and `@see` links to the hand-written docs.

## Reference

- **check-examples tool**: `/tooling/check-examples/`
- **Docusaurus config**: `/website/docusaurus.config.ts`
